<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Додати автоматизацію</title>
    <style>
        .rule, .action {
            margin-left: 50px;
            margin-top: 10px;
        }
    </style>
    <script>
        var idx = 0;
        function remove_rule(i) {
            document.getElementById('new-rule-' + i).remove();
        }
        function add_rule() {
            idx += 1;
            var rule_template = ''+
            '<div id="new-rule-' + idx +  '">'+
            '<select onchange="show_rule(this.value, ' + idx + ')">'+
                '<option value="rule-' + idx + '-limit">'+
                    'Температурна умова'+
                '</option>'+
                '<option value="rule-' + idx + '-motor">'+
                    'Стан насосу'+
                '</option>'+
                '<option value="rule-' + idx + '-time">'+
                    'Часова умова'+
                '</option>'+
            '</select>'+
            '<input type="button" value="видалити" onclick="remove_rule(' + idx + ');">'+

                '<div class="rule-' + idx + '-container">'+
                '<div id="rule-' + idx + '-limit" class="rule-' + idx +' rule">'+
                    '<label for="temperature-' + idx + '-number">температура:</label>'+
                    '<select id="temperature-' + idx + '-number">'+
                        '<option value="1">вулиця</option>'+
                        '<option value="2">вихід з котла</option>'+
                    '</select>'+
                    '<select id="temperature-' + idx + '-rule">'+
                        '<option value="1"> ></option>'+
                        '<option value="2"> <</option>'+
                        '<option value="3"> <=</option>'+
                        '<option value="4"> >=</option>'+
                        '<option value="5"> <></option>'+
                    '</select>'+
                    '<label for="temperature-' + idx + '-limit">значення</label>'+
                    '<input id="temperature-' + idx + '-limit" type="number">'+
                '</div>'+

                '<div id="rule-' + idx + '-motor" class="rule-' + idx +' rule" style="display: none">'+
                    '<label for="motor-' + idx + '-number">насос:</label>'+
                    '<select id="motor-' + idx + '-number">'+
                        '<option value="1">вихід з газового котла</option>'+
                        '<option value="1">вихід з деревяного котла</option>'+
                    '</select>'+
                    '<select id="motor-' + idx + '-rule">'+
                       '<option value="on"> увімкнений </option>'+
                        '<option value="off"> вимкнений </option>'+
                    '</select>'+
                '</div>'+

                '<div id="rule-' + idx + '-time" class="rule-' + idx +' rule" style="display: none">'+
                    '<label for="time-' + idx + '-start">у проміжку від:</label>'+
                    '<input id="time-' + idx + '-start" type="time">'+
                    '<label for="time-' + idx + '-end"> до:</label>'+
                    '<input id="time-' + idx + '-end" type="time">'+
                '</div>'+
            '</div>'+
            '<hr>'+
        '</div>';



            document.getElementById('rules').insertAdjacentHTML('beforeend', rule_template);
        }
        function show_rule(rule, i) {
            rules = document.getElementsByClassName('rule-'+i);
            for (var index = 0; index < rules.length; index++) {
                rules[index].style.display = 'none'
            }
            document.getElementById(rule).style.display = 'block';
        }

    </script>
</head>
<body>
<form action="/automation/add/save">
    <label for="rules">Правила</label>
    <div id="rules">

    </div>
    <br>
    <input type="button" value="додати умову" onclick="add_rule()">
    <br>
    <br>
    <label for="actions">Події</label>
    <div id="actions">


        <div id="new-action-1">
            <select onchange="show_action(this.value, 1)">
                <option value="action-1-motor">Робота з насосом</option>
                <option value="action-1-3-way-clap">Робота з трьох-ходовим
                    клапаном
                </option>
                <option value="action-1-clap">Робота з клапаном</option>
                <option value="action-1-vent">Робота з вентилятором</option>
            </select>
            <input type="button" value="видалити"
                   onclick="remove_action(1);">

            <div class="action-1-container">
                <div id="action-1-motor" class="action-1 action"
                     style="display: block;"><label for="motor-1-number">насос:</label>
                    <select id="motor-1-number">
                        <option value="1">вихід з газового котла</option>
                        <option value="1">вихід з деревяного котла</option>
                </select>
                    <select id="motor-1-action">
                    <option value="1"> увімкнути </option>
                    <option value="2"> вимкнути </option>
                    <option value="3"> перемкнути стан </option>
                </select>

                    <input id="motor-1-action-rev" type="checkbox"><label for="motor-1-action-rev">зворотній стан при не виконанні правил</label>

                <div id="action-1-3-way-clap" class="action-1 action"
                     style="display: none;"><label for="time-1-start">у проміжку
                    від:</label><label
                        for="action-1-3-way-clap-mode"> Режим роботи:</label>
                    <select id="action-1-3-way-clap-mode">
                        <option value="1"> закрити </option>
                    <option value="2"> 1 -> 2 </option>
                    <option value="3"> 2 -> 3 </option>
                    </select>
            </div>
            <hr>
        </div>


    </div>
    <input type="button" value="додати подію" onclick="add_action()">
    <br>
    <br>
    <input type="reset" value="відміна"
           onclick="window.location.href='/automation/'">
    <input type="submit" value="зберегти">
</form>
</body>
</html>